(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5579],{57914:function(s,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/extension/integration/bitcoin/sign-psbt",function(){return n(82081)}])},82081:function(s,e,n){"use strict";n.r(e),n.d(e,{__toc:function(){return o}});var i=n(11527),r=n(77178),l=n(12783);let o=[{depth:2,value:"Sign PSBT",id:"sign-psbt"},{depth:2,value:"SDK Integration (Tomo Wallet SDK)",id:"sdk-integration-tomo-wallet-sdk"},{depth:3,value:"Sign a Single PSBT",id:"sign-a-single-psbt"},{depth:3,value:"Sign Multiple PSBTs",id:"sign-multiple-psbts"},{depth:2,value:"Vanilla JavaScript",id:"vanilla-javascript"},{depth:3,value:"Access Provider",id:"access-provider"},{depth:3,value:"Sign a Single PSBT",id:"sign-a-single-psbt-1"},{depth:3,value:"Sign Multiple PSBTs",id:"sign-multiple-psbts-1"},{depth:2,value:"Input Requirements",id:"input-requirements"},{depth:2,value:"What the wallet returns",id:"what-the-wallet-returns"},{depth:2,value:"Notes and Best Practices",id:"notes-and-best-practices"},{depth:2,value:"Creating PSBTs (Before Signing)",id:"creating-psbts-before-signing"},{depth:2,value:"Reference: Tomo SDK + Demo",id:"reference-tomo-sdk--demo"}];function t(s){let e=Object.assign({h2:"h2",p:"p",strong:"strong",ul:"ul",li:"li",code:"code",blockquote:"blockquote",hr:"hr",h3:"h3",pre:"pre",span:"span",a:"a",ol:"ol"},(0,l.a)(),s.components);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h2,{id:"sign-psbt",children:"Sign PSBT"}),"\n",(0,i.jsxs)(e.p,{children:["This section explains how to sign ",(0,i.jsx)(e.strong,{children:"PSBT (Partially Signed Bitcoin Transactions)"}),"\nwith Cosmostation Extension."]}),"\n",(0,i.jsx)(e.p,{children:"PSBT signing is commonly used for advanced Bitcoin workflows, including:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"multi-step transaction flows (prepare → sign → finalize/broadcast)"}),"\n",(0,i.jsx)(e.li,{children:"custody-separated signing (dApp constructs PSBT, wallet signs)"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Cosmostation’s Bitcoin provider supports both:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"signPsbt(psbtHex)"})," for a ",(0,i.jsx)(e.strong,{children:"single"})," PSBT"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"signPsbts(psbtsHexes)"})," for ",(0,i.jsx)(e.strong,{children:"multiple"})," PSBTs in one flow"]}),"\n"]}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:["Note: The provider expects PSBT input as a ",(0,i.jsx)(e.strong,{children:"hex string"}),".\nInternally, Cosmostation normalizes the PSBT hex (e.g., formatting / prefix handling)\nbefore sending it to the wallet signing layer."]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"sdk-integration-tomo-wallet-sdk",children:"SDK Integration (Tomo Wallet SDK)"}),"\n",(0,i.jsxs)(e.p,{children:["If you are using ",(0,i.jsx)(e.strong,{children:"Tomo Wallet SDK"}),", PSBT signing is performed through the\nSDK-exposed ",(0,i.jsx)(e.code,{children:"bitcoinProvider"}),", which implements the ",(0,i.jsx)(e.code,{children:"BTCProvider"})," interface."]}),"\n",(0,i.jsx)(e.h3,{id:"sign-a-single-psbt",children:"Sign a Single PSBT"}),"\n",(0,i.jsx)(e.pre,{"data-language":"ts","data-theme":"default",children:(0,i.jsxs)(e.code,{"data-language":"ts","data-theme":"default",children:[(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// psbtHex: string (hex-encoded PSBT)"})}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"signedPsbt"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"bitcoinProvider"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".signPsbt"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(psbtHex);"})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:" "}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'Signed PSBT:'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" signedPsbt);"})]})]})}),"\n",(0,i.jsx)(e.h3,{id:"sign-multiple-psbts",children:"Sign Multiple PSBTs"}),"\n",(0,i.jsx)(e.pre,{"data-language":"ts","data-theme":"default",children:(0,i.jsxs)(e.code,{"data-language":"ts","data-theme":"default",children:[(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"// psbtsHexes: string[] (array of hex-encoded PSBTs)"})}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"signedPsbts"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"bitcoinProvider"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".signPsbts"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(psbtsHexes);"})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:" "}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'Signed PSBTs:'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" signedPsbts);"})]})]})}),"\n",(0,i.jsx)(e.p,{children:"Use batch signing when your flow requires multiple related signatures (for example,\nseparate PSBTs for different stages or different inputs)."}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"vanilla-javascript",children:"Vanilla JavaScript"}),"\n",(0,i.jsx)(e.p,{children:"If you are not using the SDK, you can call the injected provider directly."}),"\n",(0,i.jsx)(e.h3,{id:"access-provider",children:"Access Provider"}),"\n",(0,i.jsx)(e.pre,{"data-language":"js","data-theme":"default",children:(0,i.jsxs)(e.code,{"data-language":"js","data-theme":"default",children:[(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"bitcoin"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" () "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'cosmostation'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"in"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" window) "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"return"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"window"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"."}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"cosmostation"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:".bitcoin;"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"window"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".open"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'https://cosmostation.io/wallet/#extension'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"};"})}),"\n",(0,i.jsx)(e.span,{className:"line",children:" "}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"provider"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"bitcoin"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"();"})]})]})}),"\n",(0,i.jsx)(e.h3,{id:"sign-a-single-psbt-1",children:"Sign a Single PSBT"}),"\n",(0,i.jsx)(e.pre,{"data-language":"ts","data-theme":"default",children:(0,i.jsxs)(e.code,{"data-language":"ts","data-theme":"default",children:[(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"provider"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".connectWallet"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"();"})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:" "}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"try"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"signedPsbt"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"provider"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".signPsbt"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(psbtHex);"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'Signed PSBT:'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" signedPsbt);"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"} "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"catch"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (e"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"any"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"e"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"?.code "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"==="}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"4001"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'User rejected the request'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  } "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".error"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(e);"})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,i.jsx)(e.h3,{id:"sign-multiple-psbts-1",children:"Sign Multiple PSBTs"}),"\n",(0,i.jsx)(e.pre,{"data-language":"ts","data-theme":"default",children:(0,i.jsxs)(e.code,{"data-language":"ts","data-theme":"default",children:[(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"provider"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".connectWallet"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"();"})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:" "}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"try"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"signedPsbts"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"provider"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".signPsbts"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(psbtsHexes);"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'Signed PSBTs:'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" signedPsbts);"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"} "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"catch"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" (e"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"any"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" ("}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"e"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"?.code "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"==="}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"4001"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:") {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'User rejected the request'"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:");"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  } "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"else"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,i.jsxs)(e.span,{className:"line",children:[(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"console"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:".error"}),(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"(e);"})]}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,i.jsx)(e.span,{className:"line",children:(0,i.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"input-requirements",children:"Input Requirements"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"psbtHex"})," must be a ",(0,i.jsx)(e.strong,{children:"valid PSBT hex string"})]}),"\n",(0,i.jsxs)(e.li,{children:["For batch signing, every entry in ",(0,i.jsx)(e.code,{children:"psbtsHexes"})," must be a valid PSBT hex string"]}),"\n",(0,i.jsx)(e.li,{children:"The wallet will reject malformed PSBTs or unsupported signing requests"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"what-the-wallet-returns",children:"What the wallet returns"}),"\n",(0,i.jsx)(e.p,{children:"The exact output type depends on your provider’s implementation, but conceptually:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["For ",(0,i.jsx)(e.code,{children:"signPsbt"}),", you receive the ",(0,i.jsx)(e.strong,{children:"signed PSBT"})," result"]}),"\n",(0,i.jsxs)(e.li,{children:["For ",(0,i.jsx)(e.code,{children:"signPsbts"}),", you receive an array of ",(0,i.jsx)(e.strong,{children:"signed PSBTs"}),", preserving the input order"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"In most dApps, the next step after signing is one of:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"finalize the PSBT into a raw transaction using your Bitcoin library/tooling"}),"\n",(0,i.jsxs)(e.li,{children:["broadcast the final transaction using your own backend or via ",(0,i.jsx)(e.code,{children:"pushTx(txHex)"})]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"notes-and-best-practices",children:"Notes and Best Practices"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Always call ",(0,i.jsx)(e.code,{children:"connectWallet()"})," before signing"]}),"\n",(0,i.jsxs)(e.li,{children:["If your PSBT flow depends on a specific network (mainnet/testnet/signet),\ncheck ",(0,i.jsx)(e.code,{children:"getNetwork()"})," first and guide the user accordingly"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"creating-psbts-before-signing",children:"Creating PSBTs (Before Signing)"}),"\n",(0,i.jsxs)(e.p,{children:["Cosmostation Extension ",(0,i.jsx)(e.strong,{children:"does not construct PSBTs"}),".\nYour dApp is responsible for creating a valid PSBT ",(0,i.jsx)(e.strong,{children:"before"})," passing it to the wallet for signing."]}),"\n",(0,i.jsxs)(e.p,{children:["For PSBT construction, input selection, and transaction assembly,\nrefer to the official ",(0,i.jsx)(e.strong,{children:"bitcoinjs-lib"})," documentation:"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/bitcoinjs/bitcoinjs-lib",children:"bitcoinjs-lib (GitHub)"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/bitcoinjs/bitcoinjs-lib/blob/master/test/integration/transactions.spec.ts",children:"PSBT guide"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://bitcoinjs.github.io/bitcoinjs-lib/",children:"API reference"})}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["Typical PSBT creation flow with ",(0,i.jsx)(e.code,{children:"bitcoinjs-lib"}),":"]}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["Initialize a ",(0,i.jsx)(e.code,{children:"Psbt"})," instance with the correct network"]}),"\n",(0,i.jsx)(e.li,{children:"Add inputs (UTXOs, scripts, witnesses)"}),"\n",(0,i.jsx)(e.li,{children:"Add outputs (recipient addresses, change)"}),"\n",(0,i.jsxs)(e.li,{children:["Export PSBT as hex (",(0,i.jsx)(e.code,{children:"psbt.toHex()"}),")"]}),"\n",(0,i.jsxs)(e.li,{children:["Pass the PSBT hex to ",(0,i.jsx)(e.code,{children:"signPsbt"})," or ",(0,i.jsx)(e.code,{children:"signPsbts"})]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Ensure that:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Inputs belong to the connected wallet"}),"\n",(0,i.jsx)(e.li,{children:"The PSBT matches the active Bitcoin network"}),"\n",(0,i.jsxs)(e.li,{children:["Required fields for signing (e.g. ",(0,i.jsx)(e.code,{children:"witnessUtxo"}),") are properly set"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"reference-tomo-sdk--demo",children:"Reference: Tomo SDK + Demo"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://docs.tomo.inc/tomo-sdk/tomo-web-sdk/bitcoin-provider#sign-psbt",children:"Tomo Docs – Sign PSBT"})}),"\n"]})]})}e.default=(0,r.j)({MDXContent:function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,l.a)(),s.components);return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(t,{...s})}):t(s)},pageOpts:{filePath:"pages/extension/integration/bitcoin/sign-psbt.mdx",route:"/extension/integration/bitcoin/sign-psbt",timestamp:1766986665e3,title:"Sign Psbt",headings:o},pageNextRoute:"/extension/integration/bitcoin/sign-psbt"})}},function(s){s.O(0,[7178,9774,2888,179],function(){return s(s.s=57914)}),_N_E=s.O()}]);